## 5.1 业务逻辑组织模式

![image-20250508164859394](image\image-20250508164859394.png)

### 5.1.1 使用事务脚本模式设计业务逻辑

- 业务逻辑相对较简单时，没必要实现面向对象，可以使用面向过程的方法来实现。

- 使用事务脚本模式时，脚本通常位于服务类中。
- 每个服务类都有一个用于请求或者系统操作的方法，这个方法实现该请求的业务逻辑。
- 它使用数据访问对象访问数据库。

### 5.1.2 使用领域模型模式设计业务逻辑

- 使用面向对象设计。

### 5.1.3 关于领域驱动设计

- 实体（entity）：具有持久化ID的对象。
- 值对象（value object）：作为值集合的对象。
- 工厂（factory）：负责实现对象创建逻辑的对象或方法。
- 存储库（repository）：用来访问持久化实体的对象。
- 服务（service）：实现不属于实体或值对象的业务逻辑的对象。

## 5.2 使用聚合模式设计领域模型

### 5.2.1 模糊边界所带来的问题

- 假设一个订单，有两位消费者。
- 两个消费者再使用事务来更新订单时，可能存在的问题，A 获取订单，更新中，B获取订单，更新中，A，B先后提交订单修改，此时可能存在冲突。两个人不知道对方对于订单的修改。
- （为啥会存在这种业务场景，直接更新订单，暂存的方案是否更合适? ）

### 5.2.2 聚合拥有明确的边界

- 聚合是一个边界内的领域对象的集群，可以将其视为一个单元。
- 聚合代表了一致的边界
- 识别聚合是关键

### 5.2.3 聚合的规则

- 规则一：只引用聚合根
- 规则二：聚合间的引用必须使用主键
- 规则三：在一个事务中，只能创建或更新一个聚合































