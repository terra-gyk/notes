## 3.1 微服务架构中的进程间通信概述

- 基于同步请求/响应的通信机制：htpp rest 或者 gRPC
- 异步的基于消息的通信机制，消息队列 or TCP通讯

### 3.1.1 交互方式

- 一对一：每个客户端请求由一个服务实例来处理
- 一对多：每个客户端请求由多个服务实例来处理
- 同步模式：客户端请求需要服务端实时响应，等待可能导致客户端阻塞
- 异步模式：非实时响应，客户端不会阻塞

![image-20250228101230677](image\image-20250228101230677.png)

- 一对一的交互方式：
  - 请求/响应：响应快，可能阻塞，紧耦合
  - 异步请求/响应：响应没那么快
  - 单向通知：无响应，无法感知服务是否收到
- 一对多的交互方式：
  - 发布/订阅方式：可以被多个服务订阅，不一定返回
  - 发布/异步响应方式：客户端发布，等待感兴趣服务返回

### 3.1.2 在微服务架构中定义API

- API 是软件开发的中心。应用是由模块构成的，每个模块都有接口，这些接口定义了模块的客户端可以调用若干操作。一个设计良好的接口会在暴露有用功能的同时隐藏实现细节。细节可以被修改，而接口保持不变。
- 如何定义API取决于你使用的进程通讯机制。例如，如果你正在使用消息机制，则API由消息通道、消息类型和消息格式组成。如果使用HTTP，则API由URL、HTTP动词以及请求和响应格式组成。

### 3.1.3 API的演化

- API不可避免地会随着应用功能地增减而发生变化。
- 进行次要并且向后兼容的改变
  - 老版本客户端可以直接使用
- 进行主要并且不向后兼容的改变
  - 客户端可能无法同时升级，因此需要保留对旧版本API的支持

### 3.1.4 消息的格式

- 进程间通信的本质是交换消息。
- 基于文本的消息格式：可读性好，相对比较冗长
- 二进制消息格式：Protocal Buffers，编译器会自动生产序列化和反序列化的代码



## 3.2 基于同步远程过程调用模式的通信













