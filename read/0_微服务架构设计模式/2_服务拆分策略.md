## 2.1 微服务架构到底是什么

### 2.1.1 软件架构是什么，为什么它如此重要

- 计算机系统的软件架构是构建这个系统所需要的一组结构，包括软件元素、它们之间的关系以及两者的属性。
- 架构的重要性在于，它帮助应用程序满足了非功能性需求。也称之为质量属性需求，这些需求决定了一个应用程序在运行时的质量，比如可拓展性和可靠性；也决定了开发阶段的质量，包括可维护性、可测试性、可拓展性和可部署性。

### 2.1.2 什么是架构风格

- 分层式架构风格
  - 表现层：包含实现用户界面或外部api的代码
  - 业务逻辑层：包含业务逻辑
  - 数据持久化层：实现与数据库交互的逻辑

- 六边形架构

  ![image-20250114171012749](image\image-20250114171012749.png)

### 2.1.3 微服务架构是一种架构风格

![image-20250114171253207](image\image-20250114171253207.png)

- 服务：是一个单一的、可独立部署的软件组织，它实现了一些有用的功能。
- 松耦合：服务之间的交互采用api完成，这样就封装了服务的实现细节。
- 共享库：应该用来实现不太可能改变的功能。
- 服务的大小不重要：微服务不等于很小的服务。其特点是职责单一。

## 2.2 为应用程序定义微服务架构

1. 第一步确定需求：将应用程序的需求提炼为各种关键请求。不是针对特定的技术，而是系统操作，程序必须处理请求的一种抽象描述。
2. 第二步确定如何分解服务。
3. 第三步确定每个服务的api：将1中标识的系统操作分配给服务。

### 2.2.1 识别系统操作

- 创建抽象领域模型
- 定义系统操作

### 2.2.2 根据业务能力进行服务拆分

- 业务能力是指一些能够为公司（或组织）产生价值的商业活动。
- 业务能力定义了一个组织的工作：组织采用何种方式来实现它的业务能力是随时间变化的。
- 识别业务能力：通过对组织的目标、结构和商业流程的分析得来的。
- 业务能力通常集中在特定的业务对象上。
- 从业务能力到服务：一旦确定了业务能力，就可以为每个能力或相关能力组定义服务。

### 2.2.3 根据子域进行服务拆分

- 领域驱动设计方法论

### 2.2.4 拆分的指导原则

- 单一职责原则
- 闭包原则

### 2.2.5 拆分单体应用为服务的难点

- 网络延迟
  - 服务间的往返调用
- 同步进程间通讯导致可用性降低
- 在服务之间维持数据一致性
  - 更新多个服务中的数据时，维护服务之间的数据一致性。
- 获取一致的数据视图
  - 跨多个数据库
- 上帝类阻碍了拆分
  - 整个应用程序中使用的全局类

### 2.2.6 定义服务API

- 服务API：服务的操作和事件
- 把系统操作分配给服务







