// 如果想修改最近一次提交的提交信息

git commit --amend

这会把你带入文本编辑器，里面包含了你最近一条提交信息，供你修改。 当保存并关闭编辑器后，编辑器将会用你输入的内容替换最近一条提交信息。

如果你已经完成提交，又因为之前提交时忘记添加一个新创建的文件，想通过添加或修改文件来更改提交的快照，也可以通过类似的操作来完成。 

通过修改文件然后运行 git add 或 git rm 一个已追踪的文件，随后运行 git commit --amend 拿走当前的暂存区域并使其做为新提交的快照。

使用这个技巧的时候需要小心，因为修正会改变提交的 SHA-1 校验和。 它类似于一个小的变基 - 如果已经推送了最后一次提交就不要修正它。







---
`git amend` 是 `git commit --amend` 的简写形式，用于修改最近一次提交的内容或信息。它可以：
- 合并暂存区的修改到上一个提交。
- 修改提交信息（如拼写错误、补充说明）。
- 添加遗漏的文件到上一个提交。


### **基本用法**
#### 1. **修改提交信息**
```bash
git commit --amend -m "新的提交信息"
```
- **示例**：修正上次提交的拼写错误：
  ```bash
  git commit --amend -m "Fix typo in README"
  ```

#### 2. **追加文件到上次提交**
```bash
git add <遗漏的文件>
git commit --amend --no-edit  # 保留原提交信息
```
- **示例**：添加 `config.js` 到上次提交：
  ```bash
  git add config.js
  git commit --amend --no-edit
  ```

#### 3. **修改提交时间**
```bash
GIT_COMMITTER_DATE="$(date)" git commit --amend --no-edit
```
- 同时修改作者时间和提交时间：
  ```bash
  GIT_AUTHOR_DATE="$(date)" GIT_COMMITTER_DATE="$(date)" git commit --amend --no-edit
  ```


### **工作原理**
- `git amend` 并非真正修改历史提交，而是创建一个**新提交**替换原提交，原提交被丢弃（若未被引用）。
- **提交哈希值会改变**，因此**不要对已推送的提交使用 amend**（除非团队明确允许）。


### **常见场景**
#### 1. **修正错误的提交信息**
```bash
# 原提交信息："Add feautre"（拼写错误）
git commit --amend -m "Add feature"  # 修正拼写
```

#### 2. **合并多次小提交**
```bash
# 连续做了多次小修改，想合并为一个提交
git add .
git commit --amend --no-edit  # 合并到上次提交
```

#### 3. **替换上次提交的内容**
```bash
# 发现上次提交的代码有问题，修改后替换
git add .
git commit --amend --no-edit  # 替换原提交
```


### **注意事项**
1. **不要修改已推送的提交**  
   若强行推送修改后的提交（`git push -f`），会导致与远程仓库的历史冲突，影响协作者。

2. **使用 `--no-edit` 保留原信息**  
   若只需修改内容，而非提交信息，务必添加 `--no-edit`。

3. ** amend 后分支领先远程分支**  
   若误对已推送的提交 amend，需强制推送到远程：
   ```bash
   git push -f origin <分支名>  # 谨慎使用！
   ```


### **与 `git rebase -i` 的对比**
| **场景**               | `git commit --amend`        | `git rebase -i`            |
|------------------------|-----------------------------|---------------------------|
| **修改最近一次提交**   | 简单高效                    | 需进入交互式界面          |
| **修改多个历史提交**   | 不适用                      | 可选择多个提交进行修改    |
| **合并多个提交**       | 只能合并到最近一次提交      | 可合并任意数量的提交      |


### **总结**
- **适用场景**：快速修正本地最近一次提交的内容或信息。
- **安全边界**：仅用于未推送的提交，避免影响团队协作。
- **替代方案**：若需修改多个历史提交，使用 `git rebase -i`。

合理使用 `git amend` 可以保持提交历史的整洁性，但需谨记：**不要修改已共享的提交**。